function initShorts(){new class{constructor(){this.el=document.querySelector(".header"),this.toggleAsideMenus(),this.setPaddingTop(),this.onScroll(),this.toggleSearchResults(),this.toggleFooterItems()}toggleAsideMenus(){function e(e,t,r){r.classList.contains("__active")?(e.forEach((e=>e.classList.remove("__active"))),t.classList.remove("__active")):(e.forEach((e=>e.classList.add("__active"))),t.classList.add("__active"))}[["icon__cart","cart"],["icon__menu","menu"]].forEach((t=>{let r=document.querySelectorAll(`.${t[0]}`),s=document.querySelector(`.${t[1]}`);function o(){e(r,s,this)}r.forEach((e=>e.addEventListener("click",o))),s.addEventListener("click",(function(t){t.target.classList.contains("aside-menu")&&e(r,s,this)}))}))}setPaddingTop(){let e=this.el.offsetHeight;const t=document.querySelector(".start-block"),r=t.querySelector(".start-block__wrapper");r?r.style.paddingTop=`${e}px`:t.style.paddingTop=`${e}px`}onScroll(){setTimeout((()=>{t=t.bind(this);let e=this.el.offsetHeight;function t(){window.pageYOffset>e?this.el.classList.add("__fixed"):this.el.classList.remove("__fixed")}t(),window.addEventListener("scroll",t)}),0)}toggleSearchResults(){const e=this.el.querySelector(".search"),t=e.querySelector("input");t.addEventListener("focus",(function(){e.classList.add("__active")})),t.addEventListener("blur",(function(){e.classList.remove("__active")}))}toggleFooterItems(){const e=document.querySelectorAll(".footer__item");function t(e){e.classList.remove("__active")}e.forEach((r=>{r.addEventListener("click",(function(s){s.target.classList.contains("item__header")&&(r.classList.contains("__active")?t(r):function(r){e.forEach((e=>{t(e)})),r.classList.add("__active")}(r))}))}))}};new class{constructor(){const e=document.querySelectorAll(".select");this.list=e,this.list.forEach((e=>{this.setValues(e),this.setSelected(e),this.toggleSelect(e),this.setInputHandlers(e)}))}setValues(e){e.querySelector('input[type="radio"]:checked')||(e.querySelector('input[type="radio"]').checked=!0);e.querySelectorAll('input[type="radio"]').forEach((e=>{const t=e.closest(".option");let r=document.createElement("span");r.innerHTML=e.value,t.append(r)}))}toggleSelect(e){e.addEventListener("click",(()=>e.classList.toggle("__active")))}setSelected(e){let t=e.querySelector('input[type="text"]');t||(t=document.createElement("input"),t.type="text",t.setAttribute("readonly",!0),e.prepend(t));const r=e.querySelector('input[type="radio"]:checked');t.value=r.value}setInputHandlers(e){t=t.bind(this);function t(){this.setSelected(e),e.classList.remove("__active")}e.querySelectorAll('input[type="radio"]').forEach((e=>{e.addEventListener("change",t)}))}}}function getStorage(e){let t=localStorage.getItem(e);return t||(t="[]"),t=JSON.parse(t),t}function setStorage(e,t){let r=JSON.stringify(t);localStorage.setItem(e,r)}function syncColorImage(e,t,r=null){setTimeout((()=>{const s=e.closest("[data-product-name]"),o=e.querySelector(".swiper-slide-active"),i=s.querySelector("input[data-color-code]:checked");if(i.dataset.colorCode!==o.dataset.colorCode){if("onSlider"===t){const e=o.dataset.colorCode;s.querySelector(`input[data-color-code="${e}"]`).checked=!0;const t=new Event("change");i.closest("form").dispatchEvent(t)}if("onForm"===t){const e=i.dataset.colorCode,t=s.querySelector(`.swiper-slide[data-color-code="${e}"]`),o=parseInt(t.dataset.swiperSlideIndex)+1;r.slideTo(o)}}}),0)}function swiperSlidersInit(){return{bikeSlider:new Swiper(".bike-slider",{wrapperClass:"bike-slider__wrapper",slideClass:"bike-slider__slide",slidesPerView:1,centeredSlides:!0,loop:!0,navigation:{prevEl:".bike-slider__button-prev",nextEl:".bike-slider__button-next"},pagination:{el:".bike-slider__pagination",clickable:!0},on:{observerUpdate(e){e.update()},slideChangeTransitionEnd(e){syncColorImage(e.el,"onSlider")}}}),categoriesSlider:new Swiper(".categories-slider",{wrapperClass:"categories-slider__wrapper",slideClass:"categories-slider__slide",centeredSlides:!0,slidesPerView:1,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{993:{slidesPerView:2}},on:{observerUpdate(e){e.update()}}}),newsSlider:new Swiper(".news-slider",{wrapperClass:"news-slider__wrapper",slideClass:"news-slider__slide",slidesPerView:1,spaceBetween:40,loop:!0,navigation:{nextEl:".news-slider-button__next",prevEl:".news-slider-button__prev"},pagination:{el:".streetster-slider__pagination",clickable:!0},breakpoints:{341:{spaceBetween:0},890:{slidesPerView:2},1320:{slidesPerView:3}},on:{observerUpdate(e){e.update()}}})}}const productAppBlock=document.querySelector("#products-app");let products;function initVueApps(){if(productAppBlock){const e={data:()=>({json:{products:products,prodBikes:products.bikes,prodAccs:products.accessories},html:{productBlocks:[],totalPrice:0},cart:{prodInfo:{},isAddedToCart:!1,addedToCartInfo:{},storage:getStorage("streetster_cart"),totalPrice:0}}),mounted(){this.html.productBlocks=Array.from(document.querySelectorAll("[data-product-name]")),this.sliders=swiperSlidersInit(),initShorts(),this.refreshCart(),this.setFirstOption(),this.setColorChangeListener(),this.getProdInfo()},methods:{setFirstOption(){this.html.productBlocks.forEach((e=>{e.querySelectorAll(".params").forEach((e=>{e.querySelector('input[type="radio"]').checked=!0}))}))},setColorChangeListener(){this.html.productBlocks.forEach((e=>{o=o.bind(this);let t,r=e.querySelectorAll("input[data-color-code]")[0].closest("form"),s=e.querySelector(".bike-slider");function o(){syncColorImage(s,"onForm",t)}this.sliders.bikeSlider.length?this.sliders.bikeSlider.forEach((e=>{e.el===s&&(t=e)})):t=this.sliders.bikeSlider,r.addEventListener("change",o)}))},calcTotalProdPrice(e,t){t=parseInt(t);let r=0;e.length>0&&e.forEach((e=>{r+=parseInt(e.price)})),this.html.totalPrice=t+r},getProdInfo(){const e=document.querySelector(".bike-page__start-block");if(e&&e.dataset.productName){t=t.bind(this),r=r.bind(this);const s=e.dataset.productName,o=this.json.prodBikes[s].price,i=t(),c=r();this.calcTotalProdPrice(c,o);const a={name:function(e){if(e){let t=e.split("-"),r="";for(let e=0;e<t.length;e++)r+=t[e][0].toUpperCase()+t[e].slice(1),e!==t.length-1&&(r+=" ");return r}return e}(s),id:s,totalProdPrice:this.html.totalPrice,prodPrice:o,params:i,accs:c};function t(){const t=e.querySelector(".bike-order__params").querySelectorAll(".params"),r={};return t.forEach((e=>{const t=e.dataset.paramName;if("radio"===e.querySelector("input").type){const o=e.querySelector("input:checked").dataset.paramIndex;let i={};"color"===t?(i.name=this.json.prodBikes[s].colors.name,i.info=this.json.prodBikes[s].colors.list[o].name2,i.addInfo=this.json.prodBikes[s].colors.list[o]):(i.name=this.json.prodBikes[s].params[t].name,i.info=this.json.prodBikes[s].params[t].list[o]),r[t]=i}})),r}function r(){const t=e.querySelector(".accessories__list").querySelectorAll(".accessories-item"),r=[];return t.forEach((e=>{const t=e.querySelector("input:checked");if(t){const e=t.dataset.accName,s=this.json.prodAccs[e];r.push(s)}})),r}this.cart.prodInfo=a}},addToCart(){const e=getStorage("streetster_cart");e.push(this.cart.prodInfo),setStorage("streetster_cart",e),this.cart.isAddedToCart=!0,this.cart.addedToCartInfo=this.cart.prodInfo,this.refreshCart()},removeFromCart(e,t=null,r=null){if(t||(t=getStorage("streetster_cart")),null==r&&t.splice(e,1),r||0==r){const s=t[e],o=s.accs[r];s.totalProdPrice=s.totalProdPrice-parseInt(o.price),s.accs.splice(r,1)}setStorage("streetster_cart",t),this.refreshCart(),this.cart.isAddedToCart=!1},cancelOrder(){const e=getStorage("streetster_cart");let t=e.findIndex((e=>{const t=e.name,r=JSON.stringify(e.params),s=this.cart.addedToCartInfo.name,o=JSON.stringify(this.cart.addedToCartInfo.params);return t==s&&r==o}));t=parseInt(t),t+1&&this.removeFromCart(t,e)},orderMore(){this.cart.isAddedToCart=!1},refreshCart(){const e=getStorage("streetster_cart");this.cart.totalPrice=function(){let t=0;return e.forEach((e=>t+=parseInt(e.totalProdPrice))),t}(),this.cart.storage=e,this.cart.storageLength=e.length}}};Vue.createApp(e).mount("#products-app")}}productAppBlock?fetch("../../js/JSON/products.json").then((e=>e.json())).then((e=>{products=e,initVueApps()})):(swiperSlidersInit(),initShorts());